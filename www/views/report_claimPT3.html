<script>
var store = Rhaboo.persistent('policy');
function saveClaim(){

	var uname = store.Name;
	var uphone = store.phone;
	var upostcode = store.postcode;
	var uemail = store.email;
	var uunitType = store.unitType;
	var uinsurer = store.insurer;
	var upolicyNumber = store.policyNumber;
	var urenewalDate = store.renewalDate;
	var umake = store.make;
	var umodel = store.model;
	var uvin = store.vin;
	var photo1SRC = store.photo1SRC;
	var photo2SRC = store.photo2SRC;
	var photo3SRC = store.photo3SRC;
	var photo4SRC = store.photo4SRC;
	var photo5SRC = store.photo5SRC;
	var photo6SRC = store.photo6SRC;

	//Claim fields
	var incidentDate = store.incidentDate;
	var claimlocation = store.claimlocation;
	var incidentDetails = store.incidentDetails;
	var claimphoto1SRC = store.claimphoto1SRC;
	var claimphoto2SRC = store.claimphoto2SRC;

	$.ajax({
		type:"POST",
		//url: "http://www.popbumper.co.uk/claim.php",
		url: "http://clubcare.hyperlogic.uk/claim.php",
		contentType: "application/x-www-form-urlencoded",
		cache: false,
		data : ({
		uname:uname,
		uphone:uphone,
		upostcode:upostcode,
		uemail:uemail,
		uunitType:uunitType,
		uinsurer:uinsurer,
		upolicyNumber:upolicyNumber,
		urenewalDate:urenewalDate,
		umake:umake,
		umodel:umodel,
		uvin:uvin,
		photo1SRC:photo1SRC,
		photo2SRC:photo2SRC,
		photo3SRC:photo3SRC,
		photo4SRC:photo4SRC,
		photo5SRC:photo5SRC,
		photo6SRC:photo6SRC,

	//Claim fields
		incidentDate:incidentDate,
		claimlocation:claimlocation,
		incidentDetails:incidentDetails,
		claimphoto1SRC:claimphoto1SRC,
		claimphoto2SRC:claimphoto2SRC

	}),
	success: function(){
		//alert(data);
		window.location = '#/sendPolicy';
	},
	error :function(){
		//alert("nope :( ");
	},
	complete : function(){
		//alert("Thank you for your registration you will receive the email with further information soon");
		//window.location=’index.html#waiting';
	}
	});

}



var tempimage = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAzJJREFUeNrsm9Fx4jAQQAVz/7iDuIM4Fdj88IuvgjMVHHzzEV8FIRXEqQBSwckd+Co40wFUwEkz68mikwccS7JA2pkd8Bhs7fPualeC0el0Ii7LmDguHoAH4AG4Ld+aN+v1msRx3Pd6z0yXTANN4z0w3cE9jn0uNJvNzgEokBcYmE7hYDOmIdOpbSGQGfTcxMYcENx0DnBByrL8Lwf4adAlY/ksJ850Y3yyect0y/TUUU1L1/FtwbYzCGPJPE6ZpnfoACnY9tIWAhxL7kAk8FplLgOwdCgdZDIAiUMAUhmA4I4MLJiOQHNbpsEaBsbpR2iAjYbghXzAVc97YaN/DV0J8sy7Yfpx4XN70BIG/Qh56Ss9RgDX4jIZygMO8LSnVxgvkz9MF+At1RdCYA4zGx3CAypwZ7Fnj1EIJBJPqaDfLwUQTx3b7QiuM0gpXMCAsfH8afwFI5ctM04C5yh8di6cX+loucca4n2BjidQgu4gyV0rIXxnK8Twu+p6RSWAWiihJwrK6qZ8xRBer3Vv0wAy5PaN8ZGC60YSCBkkWWsAUCFxFYqMxxAKdHxUFQqqAORCwtPRTaZNO4vyQW0DgEp4+huNtYVY1u5sAIAH8dgx23eVBO6BQ21wAFTWZpro5KBIOgwNoBSSlW5JJCFoTSFkAkAg6TmsAWBiTSGy2QNuTlQDqA2MubqQE4wDmBgGUNvmAVHLlKhLqG0ekKosTDoWXrENHoAB7DV7ASWfa31ERc+hAkAoPIlcI4ClkHsyGwCIRpeaGqINlL4YRmALAJ6IfqLjFem/ti+6/godP9i2HtB4wYMApVJkfCpJhIFtAAIYWFMX8FWbp57hwKFOyfkK85vKnkNHM0SF4mhFOqzToyfMvyNua72pbrl1bIw0OzkpSlr89TuESArhIevqKBi/l1SbBdGw1KZrZygECDmEwBHVCa+g18ocjNfSaeruBnOo3Z/JhU1Kifxg+ltlwjPpAWJyzEEp+dwDPLSET9ISIjcLQKwXEmKR+AURw62sLUJlADYOAShkAD4M9fM2GP/elgMWUGxUd2h4BVUk/v0CGfk/TvpZwAPwADwAD8Bd+SfAAOeTvpbQVR1SAAAAAElFTkSuQmCC"



if(store.claimphoto1SRC != undefined){
    document.getElementById("image1").src = "data:image/jpeg;base64," + store.claimphoto1SRC;
}
else{
	document.getElementById("image1").src = tempimage;
}

if(store.claimphoto2SRC != undefined){
	document.getElementById("image2").src = "data:image/jpeg;base64," + store.claimphoto2SRC;
}
else{
	document.getElementById("image2").src = tempimage;
}





var pictureSource; // picture source
var destinationType; // sets the format of returned value
var capturedPhoto = 0;

document.addEventListener("deviceready", onDeviceReady, false);


function onDeviceReady() {
	pictureSource = navigator.camera.PictureSourceType;
	destinationType = navigator.camera.DestinationType;

}

function onPhotoDataSuccess1(imageData) {
	store.write('claimphoto1SRC', imageData);
	document.getElementById("image1").src = "data:image/jpeg;base64," + imageData;
}


function onPhotoDataSuccess2(imageData) {
	store.write('claimphoto2SRC', imageData);
	document.getElementById("image2").src = "data:image/jpeg;base64," + imageData;
}


// Called when a photo is successfully retrieved
//
function onPhotoURISuccess(imageURI) {
	console.log(imageURI);
	var galleryImage = document.getElementById('image');
	galleryImage.style.display = 'block';
	galleryImage.src = imageURI;
}

function capturePhoto1() {
	navigator.camera.getPicture(onPhotoDataSuccess1, onFail, {
	quality: 50,
	encodingType : Camera.EncodingType.JPEG,
	targetWidth: 400,
	targetHeight: 400,
	destinationType: destinationType.DATA_URL,
	saveToPhotoAlbum: false,
	correctOrientation: true
	});
}


function capturePhoto2() {
	navigator.camera.getPicture(onPhotoDataSuccess2, onFail, {
	quality: 50,
	encodingType : Camera.EncodingType.JPEG,
	targetWidth: 400,
	targetHeight: 400,
	destinationType: destinationType.DATA_URL,
	saveToPhotoAlbum: false,
	correctOrientation: true
	});
}


function getPhoto(source) {
// Retrieve image file location from specified source
	navigator.camera.getPicture(onPhotoURISuccess, onFail, {
	quality: 50,
	targetWidth: 300,
	targetHeight: 600,
	destinationType: destinationType.FILE_URI,
	sourceType: source,
	correctOrientation: true
	});
}

function onFail(message) {
//alert('Failed because: ' + message);
}





</script>




<div class="homeContent">
<img class="homelogo_test" src="img/ClubCare_logo_colour.png" />
<div class="pageTitle" style="margin-top:22px;"><img src="img/defaqto.png" width="68px"/></div>
<div style="clear: both;"></div>
<div class="pageBanner">Step 3: Complete Claim</div>
<div style="clear: both;"></div>
<div class="pageBlock">

<form id="step3">

<div class="boxer">
	<div class="box-row">
		<div class="box"><img id="image1" src="" style="width:30%;" onclick="capturePhoto1();"><br><button class="btn btn-warning" style="width:85%;" onclick="capturePhoto1();">Photo 1</button></div>
		<div class="box"><img id="image2" src="" style="width:30%;" onclick="capturePhoto2();"><br><button class="btn btn-warning"  style="width:85%;" onclick="capturePhoto2();">Photo 2</button></div>
	</div>
</div>





    <button class="btn btn-success" style="width:100%;" onclick="saveClaim()" value="Save" id="Continue" data-theme="a">Finish</button>

  </div>
</form>


</div>

</div>